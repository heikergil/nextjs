name: Prod Deploy
on:   
    release:
        types: [published]
    workflow_dispatch:
      
jobs:
    build:
        timeout-minutes: 30 # nothing good happens after 30 minutes
        name: Vercel Prod Build
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - name: Use Node.js 
              uses: actions/setup-node@v3
              with:
                  node-version: '18'
                  cache: 'yarn'
                  cache-dependency-path: yarn.lock

            - name: Get node version
              id: node
              run: |
               echo "::set-output name=version::$(node -v)"

            - name: Get node_modules cache
              uses: actions/cache@v3.0.2
              id: node_modules
              with:
                path: |
                    **/node_modules
            # Adding node version as cache key
                key: ${{ runner.os }}-node_modules-${{ hashFiles('**/yarn.lock') }}-${{ steps.node.outputs.version }}

            - name: Install pakages
             # if: steps.cache-node-modules.outputs.cache-hit != 'true'
              run: yarn install --frozen-lockfile --prefer-offline